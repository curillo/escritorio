From 4a47668b56d1dbdf5a6cd2fc54dfb87f1c283fb5 Mon Sep 17 00:00:00 2001
From: Jordan Mussi <JordanMussi@users.noreply.github.com>
Date: Fri, 30 Mar 2018 15:00:31 +0100
Subject: [PATCH] Render title for non-GitHub repos

---
 app/src/models/cloning-repository.ts             | 14 +++++++++++---
 app/src/ui/clone-repository/clone-repository.tsx |  7 +++++++
 app/src/ui/cloning-repository.tsx                | 14 +++++++++++---
 3 files changed, 29 insertions(+), 6 deletions(-)

diff --git a/app/src/models/cloning-repository.ts b/app/src/models/cloning-repository.ts
index f4876af58..6708aba4b 100644
--- a/app/src/models/cloning-repository.ts
+++ b/app/src/models/cloning-repository.ts
@@ -16,11 +16,19 @@ export class CloningRepository {
   }
 
   public get name(): string {
-    if (this.remoteName === '') {
-      return Path.basename(this.path)
-    } else {
+    if (this.hasRemoteName()) {
       return this.remoteName
     }
+
+    return Path.basename(this.path)
+  }
+
+  public get basename(): string {
+    return Path.basename(this.path)
+  }
+
+  public hasRemoteName(): boolean {
+    return this.remoteName !== null && this.remoteName !== ''
   }
 
   /**
diff --git a/app/src/ui/clone-repository/clone-repository.tsx b/app/src/ui/clone-repository/clone-repository.tsx
index d18dfe66d..dd7a3e718 100644
--- a/app/src/ui/clone-repository/clone-repository.tsx
+++ b/app/src/ui/clone-repository/clone-repository.tsx
@@ -9,6 +9,7 @@ import { Account } from '../../models/account'
 import {
   IRepositoryIdentifier,
   parseRepositoryIdentifier,
+  parseRemote,
 } from '../../lib/remote-parsing'
 import { findAccountForRemoteURL } from '../../lib/find-account'
 import { API } from '../../lib/api'
@@ -350,6 +351,12 @@ export class CloneRepository extends React.Component<
         cloneData.url = repo.clone_url
         cloneData.remoteName = repo.name
       }
+    } else {
+      const parsed = parseRemote(cloneData.url)
+
+      if (parsed != null && parsed.name != null) {
+        cloneData.remoteName = parsed.name
+      }
     }
 
     return cloneData
diff --git a/app/src/ui/cloning-repository.tsx b/app/src/ui/cloning-repository.tsx
index 2d961b07c..ffbce55d8 100644
--- a/app/src/ui/cloning-repository.tsx
+++ b/app/src/ui/cloning-repository.tsx
@@ -24,13 +24,21 @@ export class CloningRepositoryView extends React.Component<
       <UiView id="cloning-repository-view">
         <div className="title-container">
           <Octicon symbol={OcticonSymbol.desktopDownload} />
-          <div className="title">
-            Cloning {this.props.repository.remoteName}
-          </div>
+          <div className="title">{this.renderTitle()}</div>
         </div>
         <progress value={progressValue} />
         <div className="details">{this.props.progress.description}</div>
       </UiView>
     )
   }
+
+  private renderTitle() {
+    const title = this.props.repository.hasRemoteName()
+      ? this.props.repository.remoteName
+      : `into ${this.props.repository.basename}`
+
+    return (
+      <span>Cloning {title}</span>
+    )
+  }
 }
-- 
2.15.1.windows.2

